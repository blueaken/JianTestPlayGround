Note the upside down tree does not need to be a BST. For each node keeps: p.left = parent.right, p.right = parent.
Recursive is much conciser than iterative.