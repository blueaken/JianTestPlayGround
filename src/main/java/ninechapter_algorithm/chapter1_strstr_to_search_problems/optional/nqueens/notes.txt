permutation template, isValid() function is the additional key.