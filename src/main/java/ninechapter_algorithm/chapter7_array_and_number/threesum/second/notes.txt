same as before, the meat is how to remove duplicates